<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ssafy.enjoy.member.model.mapper.MemberMapper">

	<select id="idCheck" parameterType="String" resultType="Integer">
		select count(*)
		from members
		where `userId`=#{id}
	</select>

	<select id="readMember" parameterType="String" resultType="member">
		select `userId`, `userPassword`, `userName`, `emailId`, `emailDomain`
		from members
		where `userId`=#{id} and `userPassword`=#{pw}
	</select>

	<insert id="createMember" parameterType="member" >
		insert into members(`userId`, `userPassword`, `userName`, `emailId`, `emailDomain`)
		values(#{userId}, #{userPassword}, #{userName}, #{emailId}, #{emailDomain})
	</insert>

	<insert id="addLoginCheck" parameterType="String">
		insert into login_check(`userId`, false)
		values(#{userId})
	</insert>

	<update id="updateMember" parameterType="modifyMember">
		update members
		set `userPassword`=#{newPassword}, `userName`=#{userName}, `emailId`=#{emailId}, `emailDomain`=#{emailDomain}
		where `userId`=#{userId} and `userPassword`=#{userPassword}
	</update>

	<select id="login" parameterType="member" resultType="String">
		select userName
		from members
		where userId = #{userId} and userName = #{userName}
	</select>

	<select id="isLogin" parameterType="String" resultType="Boolean">
		select is_login
		from login_check
		where user_id = #{userId}
	</select>

	<insert id="addLoginCheck" parameterType="String">
		insert into is_login (user_id, is_login)
		values (#{userId}, 0)
	</insert>

	<insert id="saveToken" parameterType="member" >
		insert into
		member_login (user_id, salt, access_token, refresh_token)
		values (#{userId}, #{salt},#{accessToken}, #{refreshToken})
		on duplicate key
		update salt=#{salt},access_token=#{accessToken},refresh_token=#{refreshToken}
	</insert>
</mapper>